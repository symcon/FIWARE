{
    "elements": [
        {
            "type": "ExpansionPanel",
            "name": "ServerSettings",
            "caption": "Server Settings",
            "items": [
                {
                    "type": "ValidationTextBox",
                    "name": "HostContextBroker",
                    "caption": "Host (Context-Broker)",
                    "width": "400px"
                },
                {
                    "type": "ValidationTextBox",
                    "name": "HostWebSocket",
                    "caption": "Host (WebSocket)",
                    "width": "400px"
                },
                {
                    "type": "ValidationTextBox",
                    "name": "AuthToken",
                    "caption": "Authentication-Token",
                    "width": "400px"
                },
                {
                    "type": "ValidationTextBox",
                    "name": "StorageUsername",
                    "caption": "Storage-Username",
                    "width": "400px"
                },
                {
                    "type": "PasswordTextBox",
                    "name": "StoragePassword",
                    "caption": "Storage-Password",
                    "width": "400px"
                },
                {
                    "type": "ValidationTextBox",
                    "name": "StorageBucket",
                    "caption": "Storage-Bucket",
                    "width": "400px"
                },
                {
                    "type": "ValidationTextBox",
                    "name": "StorageEndpoint",
                    "caption": "Storage-Endpoint",
                    "width": "400px"
                },
                {
                    "type": "ValidationTextBox",
                    "name": "GoogleMapsApiKey",
                    "caption": "Google Maps API-Key",
                    "width": "400px"
                }
            ]
        },
        {
            "type": "ExpansionPanel",
            "name": "BuildingSettings",
            "caption": "Building Settings",
            "items": [
                {
                    "type": "ValidationTextBox",
                    "name": "BuildingID",
                    "caption": "ID",
                    "enabled": false
                },
                {
                    "type": "ValidationTextBox",
                    "name": "BuildingOwnerEMail",
                    "validate": ".+@.+\\..+",
                    "value": "mail@domain.com",                    
                    "caption": "E-Mail",
                    "width": "300px"
                },
                {
                    "type": "RowLayout",
                    "items": [
                        {
                            "type": "ValidationTextBox",
                            "name": "BuildingOwnerName",
                            "caption": "Name",
                            "width": "130px"
                        },
                        {
                            "type": "ValidationTextBox",
                            "name": "BuildingOwnerSurname",
                            "caption": "Surname",
                            "width": "160px"
                        }
                    ]
                },
                {
                    "type": "ValidationTextBox",
                    "name": "BuildingStreet",
                    "caption": "Street",
                    "width": "300px"
                },
                {
                    "type": "RowLayout",
                    "items": [
                        {
                            "type": "ValidationTextBox",
                            "name": "BuildingPostcode",
                            "caption": "Postcode",
                            "width": "100px"
                        },
                        {
                            "type": "ValidationTextBox",
                            "name": "BuildingCity",
                            "caption": "City",
                            "width": "190px"
                        }
                    ]
                },
                {
                    "type": "SelectLocation",
                    "name": "BuildingLocation",
                    "caption": "Location"
                },
                {
                    "type": "SelectFile",
                    "name": "BuildingPlan",
                    "caption": "Plans (PDF)",
                    "width": "300px"
                },
                {
                    "type": "Label",
                    "name": "BuildingElevation",
                    "caption": ""
                }
            ]
        },
        {
            "type": "ExpansionPanel",
            "name": "Sensors",
            "caption": "Sensors",
            "items": [
                {
                    "type": "List",
                    "name": "WatchVariables",
                    "caption": "Variables",
                    "add": true,
                    "delete": true,
                    "columns": [
                        {
                            "caption": "Variable",
                            "name": "VariableID",
                            "width": "auto",
                            "add": 0,
                            "edit": {
                                "type": "SelectVariable"
                            }
                        },
                        {
                            "caption": "Category",
                            "name": "Category",
                            "width": "150px",
                            "add": "",
                            "edit": {
                                "type": "Select",
                                "options": [
                                    {
                                        "caption": "Unknown",
                                        "value": ""
                                    },
                                    {
                                        "caption": "Sensor",
                                        "value": "sensor"
                                    },
                                    {
                                        "caption": "Actuator",
                                        "value": "actuator"
                                    },
                                    {
                                        "caption": "Meter",
                                        "value": "meter"
                                    },
                                    {
                                        "caption": "HVAC",
                                        "value": "HVAC"
                                    },
                                    {
                                        "caption": "Network",
                                        "value": "network"
                                    },
                                    {
                                        "caption": "Multimedia",
                                        "value": "multimedia"
                                    },
                                    {
                                        "caption": "Implement",
                                        "value": "implement"
                                    },
                                    {
                                        "caption": "Irrigation System",
                                        "value": "irrSystem"
                                    },
                                    {
                                        "caption": "Irrigation Section",
                                        "value": "irrSection"
                                    },
                                    {
                                        "caption": "Endgun",
                                        "value": "endgun"
                                    }
                                ]
                            }
                        },
                        {
                            "caption": "Controlled Property",
                            "name": "ControlledProperty",
                            "width": "200px",
                            "add": "",
                            "edit": {
                                "type": "Select",
                                "options": [
                                    {
                                        "caption": "Unknown",
                                        "value": ""
                                    },
                                    {
                                        "caption": "Temperature",
                                        "value": "temperature"
                                    },
                                    {
                                        "caption": "Humidity",
                                        "value": "humidity"
                                    },
                                    {
                                        "caption": "Light",
                                        "value": "light"
                                    },
                                    {
                                        "caption": "Motion",
                                        "value": "motion"
                                    },
                                    {
                                        "caption": "Filling Level",
                                        "value": "fillingLevel"
                                    },
                                    {
                                        "caption": "Occupancy",
                                        "value": "occupancy"
                                    },
                                    {
                                        "caption": "Power",
                                        "value": "power"
                                    },
                                    {
                                        "caption": "Pressure",
                                        "value": "pressure"
                                    },
                                    {
                                        "caption": "Smoke",
                                        "value": "smoke"
                                    },
                                    {
                                        "caption": "Energy",
                                        "value": "energy"
                                    },
                                    {
                                        "caption": "Air Pollution",
                                        "value": "airPollution"
                                    },
                                    {
                                        "caption": "Noise Level",
                                        "value": "noiseLevel"
                                    },
                                    {
                                        "caption": "Weather Conditions",
                                        "value": "weatherConditions"
                                    },
                                    {
                                        "caption": "Precipitation",
                                        "value": "precipitation"
                                    },
                                    {
                                        "caption": "Wind Speed",
                                        "value": "windSpeed"
                                    },
                                    {
                                        "caption": "Wind Direction",
                                        "value": "windDirection"
                                    },
                                    {
                                        "caption": "Atmospheric Pressure",
                                        "value": "atmosphericPressure"
                                    },
                                    {
                                        "caption": "Solar Radiation",
                                        "value": "solarRadiation"
                                    },
                                    {
                                        "caption": "Depth",
                                        "value": "depth"
                                    },
                                    {
                                        "caption": "PH",
                                        "value": "pH"
                                    },
                                    {
                                        "caption": "Conductivity",
                                        "value": "conductivity"
                                    },
                                    {
                                        "caption": "Conductance",
                                        "value": "conductance"
                                    },
                                    {
                                        "caption": "Tss",
                                        "value": "tss"
                                    },
                                    {
                                        "caption": "Tds",
                                        "value": "tds"
                                    },
                                    {
                                        "caption": "Turbidity",
                                        "value": "turbidity"
                                    },
                                    {
                                        "caption": "Salinity",
                                        "value": "salinity"
                                    },
                                    {
                                        "caption": "Orp",
                                        "value": "orp"
                                    },
                                    {
                                        "caption": "Cdom",
                                        "value": "cdom"
                                    },
                                    {
                                        "caption": "Water Pollution",
                                        "value": "waterPollution"
                                    },
                                    {
                                        "caption": "Location",
                                        "value": "location"
                                    },
                                    {
                                        "caption": "Speed",
                                        "value": "speed"
                                    },
                                    {
                                        "caption": "Heading",
                                        "value": "heading"
                                    },
                                    {
                                        "caption": "Weight",
                                        "value": "weight"
                                    },
                                    {
                                        "caption": "Water Consumption",
                                        "value": "waterConsumption"
                                    },
                                    {
                                        "caption": "Gas Comsumption",
                                        "value": "gasComsumption"
                                    },
                                    {
                                        "caption": "Electricity Consumption",
                                        "value": "electricityConsumption"
                                    },
                                    {
                                        "caption": "Soil Moisture",
                                        "value": "soilMoisture"
                                    },
                                    {
                                        "caption": "Traffic Flow",
                                        "value": "trafficFlow"
                                    },
                                    {
                                        "caption": "Eating Activity",
                                        "value": "eatingActivity"
                                    },
                                    {
                                        "caption": "Milking",
                                        "value": "milking"
                                    },
                                    {
                                        "caption": "Movement Activity",
                                        "value": "movementActivity"
                                    }
                                ]
                            }
                        },
                        {
                            "caption": "Location",
                            "name": "Location",
                            "width": "150px",
                            "add": "{\"latitude\": 0, \"longitude\": 0}",
                            "edit": {
                                "type": "SelectLocation"
                            }
                        },
                        {
                            "caption": "Threshold (Invalid)",
                            "name": "ThresholdInvalid",
                            "width": "170px",
                            "add": [],
                            "edit": {
                                "type": "List",
                                "add": true,
                                "delete": true,
                                "rowCount": 3,
                                "columns": [
                                    {
                                        "caption": "Comparison",
                                        "name": "Comparison",
                                        "width": "125px",
                                        "add": "equal",
                                        "edit": {
                                            "type": "Select",
                                            "options": [
                                                {
                                                    "caption": "Equal (=)",
                                                    "value": "equal"
                                                },
                                                {
                                                    "caption": "Not equal (\u2260)",
                                                    "value": "notEqual"
                                                },
                                                {
                                                    "caption": "Greater (>)",
                                                    "value": "greaterThan"
                                                },
                                                {
                                                    "caption": "Greater or Equal (\u2265)",
                                                    "value": "greaterThanInclusive"
                                                },
                                                {
                                                    "caption": "Less (<)",
                                                    "value": "lessThan"
                                                },
                                                {
                                                    "caption": "Less or Equal (\u2264)",
                                                    "value": "lessThanInclusive"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "caption": "Value",
                                        "name": "Value",
                                        "width": "125px",
                                        "add": 0,
                                        "edit": {
                                            "type": "NumberSpinner"
                                        }
                                    }
                                ]
                            }
                        },
                        {
                            "caption": "Threshold (Warning)",
                            "name": "ThresholdWarning",
                            "width": "180px",
                            "add": [],
                            "edit": {
                                "type": "List",
                                "add": true,
                                "delete": true,
                                "rowCount": 3,
                                "columns": [
                                    {
                                        "caption": "Comparison",
                                        "name": "Comparison",
                                        "width": "125px",
                                        "add": "equal",
                                        "edit": {
                                            "type": "Select",
                                            "options": [
                                                {
                                                    "caption": "Equal (=)",
                                                    "value": "equal"
                                                },
                                                {
                                                    "caption": "Not equal (\u2260)",
                                                    "value": "notEqual"
                                                },
                                                {
                                                    "caption": "Greater (>)",
                                                    "value": "greaterThan"
                                                },
                                                {
                                                    "caption": "Greater or Equal (\u2265)",
                                                    "value": "greaterThanInclusive"
                                                },
                                                {
                                                    "caption": "Less (<)",
                                                    "value": "lessThan"
                                                },
                                                {
                                                    "caption": "Less or Equal (\u2264)",
                                                    "value": "lessThanInclusive"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "caption": "Value",
                                        "name": "Value",
                                        "width": "125px",
                                        "add": 0,
                                        "edit": {
                                            "type": "NumberSpinner"
                                        }
                                    }
                                ]
                            }
                        },
                        {
                            "caption": "Threshold (Alarm)",
                            "name": "ThresholdAlarm",
                            "width": "170px",
                            "add": [],
                            "edit": {
                                "type": "List",
                                "add": true,
                                "delete": true,
                                "rowCount": 3,
                                "columns": [
                                    {
                                        "caption": "Comparison",
                                        "name": "Comparison",
                                        "width": "125px",
                                        "add": "equal",
                                        "edit": {
                                            "type": "Select",
                                            "options": [
                                                {
                                                    "caption": "Equal (=)",
                                                    "value": "equal"
                                                },
                                                {
                                                    "caption": "Not equal (\u2260)",
                                                    "value": "notEqual"
                                                },
                                                {
                                                    "caption": "Greater (>)",
                                                    "value": "greaterThan"
                                                },
                                                {
                                                    "caption": "Greater or Equal (\u2265)",
                                                    "value": "greaterThanInclusive"
                                                },
                                                {
                                                    "caption": "Less (<)",
                                                    "value": "lessThan"
                                                },
                                                {
                                                    "caption": "Less or Equal (\u2264)",
                                                    "value": "lessThanInclusive"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "caption": "Value",
                                        "name": "Value",
                                        "width": "125px",
                                        "add": 0,
                                        "edit": {
                                            "type": "NumberSpinner"
                                        }
                                    }
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "type": "ExpansionPanel",
            "name": "Cameras",
            "caption": "Cameras",
            "items": [
                {
                    "type": "List",
                    "name": "WatchMedia",
                    "caption": "Media",
                    "add": true,
                    "delete": true,
                    "columns": [
                        {
                            "caption": "Media",
                            "name": "MediaID",
                            "width": "auto",
                            "add": 0,
                            "edit": {
                                "type": "SelectMedia"
                            }
                        },
                        {
                            "caption": "Location",
                            "name": "Location",
                            "width": "150px",
                            "add": "{\"latitude\": 0, \"longitude\": 0}",
                            "edit": {
                                "type": "SelectLocation"
                            }
                        }
                    ]
                }
            ]
        },
        {
            "type": "ExpansionPanel",
            "name": "Lights",
            "caption": "Lights",
            "items": [
                {
                    "type": "List",
                    "name": "ActionLights",
                    "caption": "Variables",
                    "add": true,
                    "delete": true,
                    "columns": [
                        {
                            "caption": "Variable",
                            "name": "VariableID",
                            "width": "auto",
                            "add": 0,
                            "edit": {
                                "type": "SelectVariable"
                            }
                        },
                        {
                            "caption": "Location",
                            "name": "Location",
                            "width": "150px",
                            "add": "{\"latitude\": 0, \"longitude\": 0}",
                            "edit": {
                                "type": "SelectLocation"
                            }
                        }
                    ]
                }
            ]
        },
        {
            "type": "ExpansionPanel",
            "name": "Shutters",
            "caption": "Shutters",
            "items": [
                {
                    "type": "List",
                    "name": "ActionShutters",
                    "caption": "Variables",
                    "add": true,
                    "delete": true,
                    "columns": [
                        {
                            "caption": "Variable",
                            "name": "VariableID",
                            "width": "auto",
                            "add": 0,
                            "edit": {
                                "type": "SelectVariable"
                            }
                        },
                        {
                            "caption": "Location",
                            "name": "Location",
                            "width": "150px",
                            "add": "{\"latitude\": 0, \"longitude\": 0}",
                            "edit": {
                                "type": "SelectLocation"
                            }
                        }
                    ]
                }
            ]
        },
        {
            "type": "ExpansionPanel",
            "name": "Doors",
            "caption": "Doors",
            "items": [
                {
                    "type": "List",
                    "name": "ActionDoors",
                    "caption": "Variables",
                    "add": true,
                    "delete": true,
                    "columns": [
                        {
                            "caption": "Variable",
                            "name": "VariableID",
                            "width": "auto",
                            "add": 0,
                            "edit": {
                                "type": "SelectVariable"
                            }
                        },
                        {
                            "caption": "Location",
                            "name": "Location",
                            "width": "150px",
                            "add": "{\"latitude\": 0, \"longitude\": 0}",
                            "edit": {
                                "type": "SelectLocation"
                            }
                        }
                    ]
                }
            ]
        },
        {
            "type": "ExpansionPanel",
            "name": "Windows",
            "caption": "Windows",
            "items": [
                {
                    "type": "List",
                    "name": "ActionWindows",
                    "caption": "Variables",
                    "add": true,
                    "delete": true,
                    "columns": [
                        {
                            "caption": "Variable",
                            "name": "VariableID",
                            "width": "auto",
                            "add": 0,
                            "edit": {
                                "type": "SelectVariable"
                            }
                        },
                        {
                            "caption": "Location",
                            "name": "Location",
                            "width": "150px",
                            "add": "{\"latitude\": 0, \"longitude\": 0}",
                            "edit": {
                                "type": "SelectLocation"
                            }
                        }
                    ]
                }
            ]
        }
    ],
    "actions": [
        {
            "type": "Label",
            "caption": "Bitte die Registrierung durchführen, um weitere Einstellungen freizuschalten.",
            "visible": false
        },
        {
            "type": "Button",
            "caption": "Registrieren",
            "visible": false,
            "onClick": "FW_Register($id);"
        },
        {
            "type": "PopupAlert",
            "name": "RegisterBuilding",
            "popup": {
                "closeCaption": "Abbrechen",
                "items": [
                    {
                        "type": "Label",
                        "caption": "Vielen Dank, dass Sie unser Produkt erworben haben und Ihr SmartHome mit der lokalen Feuerwehr verbinden möchten. Zur Anmeldung und Verifikation benötigen wir einige persönliche Daten, welche im folgenden ausgefüllt werden müssen. Bitte beachten Sie dazu auch unsere Allgemeinen Geschäftsbedingungen und Datenschutzbestimmungen.",
                        "width": "600px"
                    },
                    {
                        "type": "Select",
                        "name": "HubURL",
                        "caption": "Hub",
                        "options": [
                            { "caption": "INSPIRE.hub (Paderborn)", "value": "https://shregistry.inspireprojekt.de/smart-buildings/register" }
                        ]
                    },
                    {
                        "type": "ValidationTextBox",
                        "name": "BuildingOwnerEMail",
                        "validate": ".+@.+\\..+",
                        "value": "mail@domain.com",
                        "caption": "E-Mail",
                        "width": "600px"
                    },
                    {
                        "type": "RowLayout",
                        "items": [
                            {
                                "type": "ValidationTextBox",
                                "name": "BuildingOwnerName",
                                "caption": "Name",
                                "width": "300px"
                            },
                            {
                                "type": "ValidationTextBox",
                                "name": "BuildingOwnerSurname",
                                "caption": "Surname",
                                "width": "300px"
                            }
                        ]
                    },
                    {
                        "type": "ValidationTextBox",
                        "name": "BuildingStreet",
                        "caption": "Street",
                        "width": "300px"
                    },
                    {
                        "type": "RowLayout",
                        "items": [
                            {
                                "type": "ValidationTextBox",
                                "name": "BuildingPostcode",
                                "caption": "Postcode",
                                "width": "100px"
                            },
                            {
                                "type": "ValidationTextBox",
                                "name": "BuildingCity",
                                "caption": "City",
                                "width": "190px"
                            }
                        ]
                    },
                    {
                        "type": "SelectLocation",
                        "name": "BuildingLocation",
                        "caption": "Location"
                    },
                    {
                        "type": "SelectFile",
                        "name": "BuildingPlan",
                        "caption": "Plans (PDF)",
                        "width": "300px"
                    },
                    {
                        "type": "CheckBox",
                        "name": "AcceptEULA",
                        "caption": "Ich stimme den Allgemeinen Geschäftsbedingungen zu",
                        "width": "600px"
                    },
                    {
                        "type": "CheckBox",
                        "name": "AcceptDataProtection",
                        "caption": "Ich stimme den Datenschutzbedingungen zu",
                        "width": "600px"
                    },
                    {
                        "type": "Button",
                        "caption": "Registrieren",
                        "onClick": "FW_RegisterBuilding($id, $HubURL, $BuildingOwnerEMail, $BuildingOwnerName, $BuildingOwnerSurname, $BuildingStreet, $BuildingPostcode, $BuildingCity, $BuildingLocation, $BuildingPlan, $AcceptEULA, $AcceptDataProtection);"
                    }
                ]
            },
            "visible": false
        },
        {
            "type": "PopupAlert",
            "name": "RegisterBuildingPermissions",
            "popup": {
                "closeCaption": "Abbrechen",
                "items": [
                    {
                        "type": "Label",
                        "caption": "Damit die Feuerwehr im Notfall bestmöglich reagieren kann wird der Zugriff auf ggf. verfügbare Sensoren, Aktoren und Kameras benötigt. Wir empfehlen der Feuerwehr den Zugriff immer zur Verfügung zu stellen. Die Rechte werden ausschließlich im Notfall benutzt und bei jeder Benutzung werden Sie entsprechend per Push Nachricht und E-Mail benachrichtigt. Alternativ können Sie die Rechte auch nur nach vorheriger Freigabe der Feuerwehr geben. Im Notfall bekommen Sie dann eine Nachricht mit der Aufforderung zur Freigabe. Bitte beachten Sie, dass dies wertvolle Zeit bei Ihrer Rettung kosten kann. Als Experte können Sie die Zugriffsrechte auch manuell konfigurieren (nicht empfohlen).",
                        "width": "600px"
                    },
                    {
                        "type": "Select",
                        "name": "Permissions",
                        "caption": "Permissions",
                        "options": [
                            { "caption": "Im Notfall den Zugriff auf Sensoren, Aktoren und Kameras erlauben", "value": "granted" },
                            { "caption": "Zugriff auf Sensoren, Aktoren und Kameras nur nach Freigabe erlauben", "value": "approval" }
                        ],
                        "width": "600px"
                    },
                    {
                        "type": "Button",
                        "caption": "Berechtigungen Speichern",
                        "onClick": "FW_RegisterBuildingPermissions($id, $Permissions);"
                    }
                ]
            },
            "visible": false
        },
        {
            "type": "PopupAlert",
            "name": "RegisterBuildingComplete",
            "popup": {
                "items": [
                    {
                        "type": "Label",
                        "caption": "Registrierung wurde erfolgreich abgeschlossen!",
                        "width": "600px"
                    }
                ]
            },
            "visible": false
        },
        {
            "type": "ExpansionPanel",
            "name": "AccessList",
            "caption": "Access Privileges",
            "items": [
                {
                    "type": "List",
                    "name": "AccessList",
                    "caption": "",
                    "add": true,
                    "delete": true,
                    "onAdd": "$valid = json_decode($AccessList['ValidUntil']); $valid_until = mktime($valid->hour, $valid->minute, $valid->second, $valid->month, $valid->day, $valid->year); FW_AddAccessPrivilege($id, $AccessList['Requester'], $valid_until);",
                    "onEdit": "$valid = json_decode($AccessList['ValidUntil']); $valid_until = mktime($valid->hour, $valid->minute, $valid->second, $valid->month, $valid->day, $valid->year); FW_UpdateAccessPrivilege($id, $AccessList['Token'], $AccessList['Requester'], $valid_until);",
                    "onDelete": "FW_DeleteAccessPrivilege($id, $AccessList['Token']);",
                    "columns": [
                        {
                            "caption": "Token",
                            "name": "Token",
                            "width": "0px",
                            "add": "",
                            "visible": false
                        },
                        {
                            "caption": "Who?",
                            "name": "Requester",
                            "width": "auto",
                            "add": "",
                            "edit": {
                                "type": "ValidationTextBox"
                            }
                        },
                        {
                            "caption": "Valid until",
                            "name": "ValidUntil",
                            "width": "200px",
                            "add": "{\"day\": 0, \"month\": 0, \"year\": 0, \"hour\": 0, \"minute\": 0, \"second\": 0}",
                            "edit": {
                                "type": "SelectDateTime"
                            }
                        }
                    ]
                }
            ]
        }
    ]
}
